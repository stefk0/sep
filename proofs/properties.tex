\section{Свойства}
\begin{itemize}
\item 
  Да фиксираме една област на Скот $\A$. Подмножествата $P \subseteq \A$ ще наричаме {\bf свойства}.
\item
  \index{непрекъснато свойство}
  \marginpar{В \cite[стр. 166]{winskel} се наричат {\em inclusive subsets}. В \cite{bird-haskell} се наричат {\em chain-complete assertions}}
  Казваме, че $P$ е {\bf непрекъснато (или допустимо, индуктивно) свойство} над областта на Скот $\A$, ако за всяка верига $(a_i)^{\infty}_{i=0}$ от елементи на $\A$, е изпълнено:
  \begin{prooftree}
    \AxiomC{$P(a_0)$}
    \AxiomC{$P(a_1)$}
    \AxiomC{$P(a_2)$}
    \AxiomC{$P(a_3)$}
    \AxiomC{$\ldots$}
    \QuinaryInfC{$P(\bigsqcup_i a_i)$}
  \end{prooftree}
  % за която $P(a_i)$, то е изпълнено и $P(\bigsqcup_i a_i)$.
  \marginpar{Понеже $\A$ е област на Скот, ние знаем, че $\bigsqcup_i a_i$ съществува}
\end{itemize}

Нека да видим, че има свойства, който не са непрекъснати.

\begin{example}
  \label{ex:complement-not-inclusive}
  Нека да разгледаме областта на Скот от точните изображения $\Strict{\Nat_\bot}{\Nat_\bot}$.
  Да разгледаме свойството $P \subseteq \Strict{\Nat_\bot}{\Nat_\bot}$, което е дефинирано по следния начин:
  \[P(f) \dfff (\exists x \in \Nat)[f(x) = \bot].\]
  Да разгледаме изображенията $f_i$, дефинирани по следния начин:
  \begin{align*}
    f_i(x) & =
    \begin{cases}
      42, & x \in \Nat\ \&\ x \leq i\\
      \bot, & x \in \Nat\ \&\ x > i\\
      \bot, & x = \bot.
    \end{cases}
  \end{align*}
  Лесно се съобразява, че $(f_i)^{\infty}_{i=0}$ е верига в $\Strict{\Nat_\bot}{\Nat_\bot}$ и че 
  за всяко $i$, $P(f_i)$. Да разгледаме точната горна граница $g$ на тази верига, за която знаем, че
  за всяко $y \in \Nat$,
  \[g(x) = y \iff (\exists i)[f_i(x) = y].\]
  Според конструкцията на $g$, $g(x) = 42$ за всяко $x \in \Nat$.
  Оттук директно получаваме, че $\neg P(g)$.
  Така видяхме, че $P$ {\em не е непрекъснато свойство}.
\end{example}

% \begin{example}
%   Нека да разгледаме областта на Скот $\S_1$, т.е. точните функции на един аргумент.
%   Да разгледаме свойството $P \subseteq \S_1$, което е дефинирано по следния начин:
%   \[P(f) \dfff (\exists x \in \Nat)[f(x) = \bot].\]
%   Да разгледаме функциите $f_i$, дефинирани по следния начин:
%   \begin{align*}
%     f_i(x) & =
%     \begin{cases}
%       42, & x \leq i\\
%       \bot, & x > i\\
%       \bot, & x = \bot.
%     \end{cases}
%   \end{align*}
%   Ясно е, че $P(f_i)$ е изпълнено за всяко $i$.
%   Да разгледаме функцията $g = \bigsqcup_i f_i$, която е дефинирана като:
%   \[g(x) = \bigsqcup_i\{f_i(x)\}.\]
%   Лесно се съобразява, че за всяко $x \in \Nat$, $g(x) \neq \bot$. Следователно, $\neg P(g)$.
%   Така видяхме, че $P$ не е непрекъснато свойство.
% \end{example}

\begin{problem}
  \label{prob:inclusive-property}
  Докажете, че свойството $Q$ над $\Strict{\Nat_\bot}{\Nat_\bot}$, където
  \[Q(f) \iff (\forall x \in \Nat)[f(x) \neq \bot],\]
  е непрекъснато.
\end{problem}

\subsection{Основни свойства}

\begin{prop}
  \label{pr:continuous-property}
  Нека $\A$ и $\B$ са области на Скот и $f_1,f_2 \in \Cont{\A}{\B}$.
  Тогава следните свойства над $\A$ са непрекъснати:
  \begin{itemize}
  \item 
    $P(a) \dfff f_1(a) \sqsubseteq f_2(a)$;
  \item
    $P(a) \dfff f_1(a) = f_2(a)$;
  \end{itemize}
\end{prop}

\begin{prop}
  \label{pr:fixed-element-property}
  Нека $\A$ е област на Скот.
  Да фиксираме произволен елемент $a_0 \in \A$.
  Тогава следните свойства над $\A$ са непрекъснати:
  \begin{itemize}
  \item 
    $P(a) \dfff a \sqsubseteq a_0$;
  \item
    $P(a) \dfff a = a_0$;
  \end{itemize}
\end{prop}

\subsection{Сечение}
\begin{prop}
  Нека $P_1$ и $P_2$ непрекъснати свойства над областта на Скот $\A$.
  Тогава $P_1 \cap P_2$ също е непрекъснато свойство.
\end{prop}

\subsection{Обединение}

\begin{prop}
  Нека $P_1$ и $P_2$ непрекъснати свойства над областта на Скот $\A$.
  Тогава $P_1 \cup P_2$ също е непрекъснато свойство.
\end{prop}

\subsection{Допълнение}

\begin{prop}
  Съществува непрекъснато свойство $P$ над областта на Скот $\A$,
  за което $\A \setminus P$ {\bf не} е непрекъснато свойство.
\end{prop}
\begin{proof}
  Да вземем $\A = \S_1$.
  Свойството $Q$ от \Problem{inclusive-property} е непрекъснато, 
  докато $\S_1 \setminus Q = P$, което е точно свойството от \Ex{complement-not-inclusive}, а 
  за него него знаем, че не е непрекъснато.
\end{proof}

\subsection{Образ}

\begin{problem}
  Нека $P$ е непрекъснато свойство в областта на Скот $\B$.
  Нека $f \in \Cont{\A}{\B}$.
  Да разгледаме свойството 
  \[f[P] \dff \{f(a) \mid f(a) \in P\}.\]
  Не винаги $f[P]$ е непрекъснато свойство в $\A$.
\end{problem}
\ifhints
\begin{hint}
  Нека $(b_n)^\infty_{n=0}$ е верига в $\B$,
  като $\bigsqcup_n b_n$ не е елемент на веригата.
  Нека дефинираме изображението $f$ по следния начин:
  $f(\bot) \dff \bot$ и $f(n) \dff b_n$.
  Лесно се съобразява, че $f \in \Cont{\Nat_\bot}{\B}$.
  Нека $P = \Nat$, което очевидно е непрекъснато свойство, защото елементите на $\Nat$ 
  не са сравними относно плоската наредба.
  Тогава $f[P] = \{b_n \mid n \in \Nat\}$.
  Лесно се проверява, че $f[P]$ не е непрекъснато свойство.
\end{hint}
\fi

\subsection{Първообраз}

\begin{problem}
  Нека $P$ е непрекъснато свойство в областта на Скот $\B$.
  Нека $f \in \Cont{\A}{\B}$.
  Да разгледаме свойството 
  \[f^{-1}[P] \dff \{a \in \A \mid f(a) \in P\}.\]
  Докажете, че $f^{-1}[P]$ е непрекъснато свойство в $\A$.
\end{problem}

\subsection{Композиция}

\begin{problem}
  Нека $P$ е непрекъснато свойство в областта на Скот $\A \times \B$,
  а $Q$ е непрекъснато свойство в областта на Скот $\B \times \C$.
  Композицията 
  \[Q \circ P = \{\pair{a,c} \in \A\times \C \mid (\exists b\in\B)[\pair{a,b} \in P\ \&\ \pair{b,c} \in Q]\}.\]
  Докажете, че {\bf не винаги} $Q \circ P$ е непрекъснато свойство.
\end{problem}
\ifhints
\begin{hint}
  Нека $(a_n)^\infty_{n=0}$ е верига в $\A$, а $(c_n)^{\infty}_{n=0}$ е верига в $\C$,
  като и двете вериги са такива, че $\bigsqcup_n a_n$ не е елемент на $(a_n)^{\infty}_{n=0}$
  и $\bigsqcup_n c_n$ не е елемент на $(c_n)^\infty_{n=0}$.
  Нека $\B = \Nat_\bot$.  
  Тогава дефинираме свойствата по следния начин:
  \begin{align*}
    & P \dff \{\pair{a_n,n} \mid n \in \Nat\};\\
    & Q \dff \{\pair{n,c_n} \mid n \in \Nat\}.
  \end{align*}
  Лесно се проверява, че тези свойства са непрекъснати.
  Тогава,
  \[Q \circ P = \{\pair{a_n,c_n} \mid n \in \Nat\},\]
  което очевидно не е непрекъснато свойство.
\end{hint}
\fi

\subsection{Проекции}

\begin{problem}
  Нека $P$ е непрекъснато свойство в областта на Скот $\A \times \B$.
  Нека за произволно $a$ да дефинираме свойството 
  \[P_a \dff \{b \in \B \mid \pair{a,b} \in P\}.\]
  Тогава $P_a$ е непрекъснато свойство.
  Наричаме $P_a$ проекция на $P$ по първата компонента.
\end{problem}

Ние знаем, че едно изображение $f:\A\times \B \to \C$ е непрекъснато точно тогава, когато
$f$ е непрекъснато по всеки от аргументите си.
Ако $P$ е непрекъснато свойство в $\A\times\B$, то е ясно, че $P$ е непрекъснато по всяка от проекциите си.

\begin{problem}
  Да разгледаме свойството $P$ в $\A \times \B$, за което 
  имаме, че $P$ е непрекъснато свойство по всяка от проекциите.
  Вярно ли е, че тогава $P$ е непрекъснатото?
\end{problem}
\ifhints
\begin{hint}
  Нека $\A$ и $\B$ са такива области на Скот, в които има вериги съответно $(a_n)^\infty_{n=0}$ и $(b_n)^\infty_{n=0}$,
  за които $\bigsqcup_n a_n$ и $\bigsqcup_n a_n$ не са елементи на съответните вериги.
  Нека $P = \{\pair{a_n,b_n} \mid n \in \Nat\}$.
  Тогава за всяко $n$, $P_{a_n}$ и $P_{b_n}$ са непрекъснати, защото
  $P_{a_n} = \{b_n\}$ и $P_{b_n} = \{a_n\}$,
  но е очевидно, че $P$ не е непрекъснато свойство.
\end{hint}
\fi

\subsection{Универсално затваряне}

\begin{problem}
  Нека $P$ е непрекъснато свойство в областта на Скот $\A \times \B$.
  Нека за произволно $a$ да дефинираме свойството 
  \[Q \dff \{b \in \B \mid (\forall a \in \A)[\pair{a,b} \in P]\}.\]
  Вярно ли е, че $Q$ е непрекъснато свойство?
  Обосновете отговора си!
\end{problem}
\ifhints
\begin{hint}
  Вярно е.
\end{hint}
\fi
% \ifhints
% \begin{hint}
%   Нека $\A$ и $\B$ са такива области на Скот, в които има вериги съответно $(a_n)^\infty_{n=0}$ и $(b_n)^\infty_{n=0}$,
%   за които $\bigsqcup_n a_n$ и $\bigsqcup_n a_n$ не са елементи на съответните вериги.
%   Нека 
%   \[P \dff \{\pair{a_n,b_k} \mid n,k \in \Nat\} \cup \{\pair{\bigsqcup_n a_n, b_k} \mid k \in \Nat\} \cup \{\pair{\bigsqcup_n a_n, \bigsqcup_k b_k}\}.\]
%   Тогава $Q = \{a_n \mid n \in \Nat\}$.
% \end{hint}
% \fi

\subsection{Екзистенциално затваряне}

\begin{problem}
  Нека $P$ е непрекъснато свойство в областта на Скот $\A \times \B$.
  Нека за произволно $a$ да дефинираме свойството 
  \[Q \dff \{b \in \B \mid (\exists a \in \A)[\pair{a,b} \in P]\}.\]
  Вярно ли е, че $Q$ е непрекъснато свойство?
\end{problem}
\ifhints
\begin{hint}
  Разгледайте $\A = \B = \Int \cup\{-\infty,+\infty\}$.
  Нека 
  \[P = \{\pair{-n,n} \mid n \in \Nat\}.\]
  Тогава $P$ е непрекъснато свойство.
  Но тогава $Q = \{n \mid n \in \Nat\}$ не е непрекъснато свойство.
\end{hint}
\fi

\subsection{Непрекъснати изображения}

Знаем, че ако $\A$ и $\B$ са области на Скот, то съвкупността от всички непрекъснати изображения $\Cont{\A}{\B}$ образува
област на Скот. Сега ще разгледаме аналог на тази теорема за непрекъснати свойства.

\begin{prop}
  Нека $P$ и $Q$ са свойства съответно в $\A$ и $\B$.
  Да разгледаме свойството $R$ в $\Cont{\A}{\B}$ дефинирано като:
  \[R \dff \{f \in \Cont{\A}{\B} \mid (\forall a \in \A)[P(a) \implies Q(f(a))]\}.\]
  Докажете, че ако $Q$ е непрекъснато свойство, то $R$ е непрекъснато свойство.
\end{prop}

\subsection{Частична коректност}

\begin{itemize}
\item
  Да разгледаме едно свойство $I$ в областта на Скот $\A$, който наричаме условие за входа, и
  свойство $O$ в областта на Скот $\A \times \B$, който наричаме условие за изхода.
\item
  \index{частична коректност}
  {\bf Свойство от тип частична коректност} относно $I$ и $O$ представлява 
  свойство $P \subseteq \Mapping{\A}{\B}$ със следната дефиниция
  \[P(f) \dfff (\forall a \in \A)[I(a)\ \&\ f(a) \neq \bot \implies O(a,f(a))].\]
\end{itemize}

\begin{prop}
  Нека $I \subseteq \A$, а $O$ е непрекъснато свойство в $\A \times \B$.
  \[P(f) \dfff (\forall a \in \A)[I(a)\ \&\ f(a) \neq \bot \implies O(a,f(a))].\]
  Тогава свойството $P$ е непрекъснато в $\Mapping{\A}{\B}$.
\end{prop}

\begin{example}
  Нека $\A = \B = \Nat_\bot$ и $I(x) \dfff x > 1$, а $O(x,y) \dfff x,y\in\Nat\ \&\ x = y^2$.
  Ясно е, че $O$ е непрекъснато свойство в $\Nat^2_\bot$. Да разгледаме свойството
  \[P(f) \dfff (\forall x \in \Nat_\bot)[x > 1\ \&\ f(x) \neq \bot \implies O(x,f(x))].\]
  Знаем, че $P$ е от тип частична коректно и следователно е непрекъснато в областта на Скот 
  $\Mapping{\Nat^2_\bot}{\Nat_\bot}$.
  Понеже $\Sigma^\star:\Cont{\Partial{\Nat^2}{\Nat}}{\Strict{\Nat^2_\bot}{\Nat_\bot}}$, то
  $Q \dfff (\Sigma^\star)^{-1}[P]$ е непрекъснато свойство в областта на Скот $\Partial{\Nat^2}{\Nat}$.
  Ясно е, че
  \[Q(f) \equiv (\forall x \in \Nat)[x > 1\ \&\ !f(x) \implies O(x,f(x))].\]
\end{example}


\subsection{Тотална коректност}

\index{тотална коректност}
{\bf Свойство от тип тотална коректност} относно $I$ и $O$ представлява 
свойство $P \subseteq \Mapping{\A}{\B}$ със следната дефиниция
\[P(f) \dfff (\forall a \in \A)[I(a) \implies (f(a) \neq \bot\ \&\  O(a,f(a)))].\]

\begin{prop}
  Нека $I$ е свойство в $\A$, а $O$ е непрекъснато свойство в $\A \times \B$.
  Тогава свойството
  \[P(f) \dfff (\forall a \in \A)[I(a) \implies (f(a) \neq \bot\ \&\ O(a,f(a)))]\]
  е непрекъснато в $\Mapping{\A}{\B}$.
\end{prop}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../sep-notes"
%%% End:
