\section{Област на Скот от непрекъснати изображения}

Следващата теорема е важна, защото с нейна помощ се доказват много свойства на непрекъснатите изображения от по-висок ред.

\begin{theorem}\label{th:double-chain}
  \marginpar{\cite[стр. 127]{winskel}}
  \marginpar{\cite[Switch Lemma, стр. 178]{models-of-computation}}
  Нека $\A = (A,\sqsubseteq,\bot)$ да бъде област на Скот и нека множеството 
  \[\{a_{m,n} \mid m,n \in \Nat\}\] от елементи на $A$ притежава свойството, че 
  \[n \leq n^\prime\ \&\ m \leq m^\prime\ \Rightarrow\ a_{n,m} \sqsubseteq a_{n^\prime,m^\prime}.\]
  Тогава са изпълнени равенствата
  \[\bigsqcup_m(\bigsqcup_n a_{n,m}) = \bigsqcup_n(\bigsqcup_{m} a_{n,m}) = \bigsqcup_n a_{n,n}.\]
\end{theorem}
\begin{proof}
  Първо ще въведем някои означения.
  \begin{itemize}
  \item 
    Да фиксираме произволно $m$. Тогава множеството $\{a_{n,m} \mid n \in \Nat\}$ образува верига:
    \[a_{0,m} \sqsubseteq a_{1,m} \sqsubseteq a_{2,m} \sqsubseteq \cdots\]
    \marginpar{По дефиниция, всяка монотонно растяща редица в област на Скот притежава точна горна граница.}
    Следователно тя има точна горна граница $b_m \df \bigsqcup \{a_{n,m} \mid n \in \Nat\}$.
  \item
    Аналогично, при фиксирано $n$, множеството $\{a_{n,m} \mid m \in \Nat\}$ образува верига:
    \[a_{n,0} \sqsubseteq a_{n,1} \sqsubseteq a_{n,2} \sqsubseteq \ldots,\]
    която притежава точна горна граница $c_n \df \bigsqcup \{a_{n,m} \mid m \in \Nat\}$.
  \end{itemize}
  Това означава, че трябва да докажем следното:
  \[\bigsqcup_m b_m = \bigsqcup_n c_n = \bigsqcup_n a_{n,n}.\]
  \begin{enumerate}[1)]
  \item 
    Първо да съобразим, че множеството $\{b_m \mid m \in \Nat\}$ образува верига в $\A$ и следователно притежава точна горна граница $\bigsqcup_m b_m$.
    Нека да разгледаме произволни $m \leq m^\prime$.
    Тогава \[(\forall n)[a_{n,m} \sqsubseteq a_{n,m^\prime} \sqsubseteq \bigsqcup_k a_{k,m^\prime} = b_{m^\prime}].\]
    Следователно $b_{m^\prime}$ е горна граница на веригата $(a_{n,m})^{\infty}_{n=0}$ и понеже $b_m$ е точна горна граница на $(a_{n,m})^{\infty}_{n=0}$, то получаваме, че \[b_m \sqsubseteq b_{m^\prime}.\]
    Това означава, че $\chain{b}{m}$ е верига в $\A$ и тя притежава точна горна граница $\bigsqcup_m b_m$.  
  \item
    С подобни разсъждения можем да докажем, че множеството $\{c_n \mid n \in \Nat\}$ образува верига в $\A$, която притежава точна горна граница $\bigsqcup_n c_n$.
  \item
    Сега ще докажем, че \[\bigsqcup_m b_m = \bigsqcup_n c_n.\]
    Имаме, че 
    \[(\forall m)(\forall n)[a_{n,m} \sqsubseteq \bigsqcup_{i}a_{i,m} = b_m \sqsubseteq \bigsqcup_i b_i],\]
    което е еквивалентно на 
    \[(\forall n)(\forall m)[a_{n,m} \sqsubseteq b_m \sqsubseteq \bigsqcup_i b_i].\]
    Да фиксираме произволно $n$.
    Тогава $\bigsqcup_i b_i$ е горна граница на веригата $(a_{n,i})^\infty_{i=0}$.
    Следователно, $c_n = \bigsqcup_i a_{n,i} \sqsubseteq \bigsqcup_i b_i$.
    Така получаваме, че $\bigsqcup_i b_i$ е горна граница и на веригата $\chain{c}{n}$
    и тогава \[\bigsqcup_n c_n \sqsubseteq \bigsqcup_i b_i.\]
    С аналогични разсъждения можем да докажем също, че 
    \[\bigsqcup_m b_m \sqsubseteq \bigsqcup_n c_n.\]
    Така доказахме, че \[\bigsqcup_m b_m = \bigsqcup_n c_n.\]
  \item
    Достатъчно е още да докажем, че
    \[\bigsqcup_n a_{n,n} = \bigsqcup_n c_n.\]
    Ясно е, че $a_{n,n}$ е елемент на веригата ${(a_{n,m})}^{\infty}_{m=0}$ и следователно
    $a_{n,n} \sqsubseteq \bigsqcup_m a_{n,m} = c_n \sqsubseteq \bigsqcup_n c_n$.
    Получаваме, че $\bigsqcup_n c_n$ е горна граница на веригата ${(a_{n,n})}^{\infty}_{n=0}$
    и следователно $\bigsqcup_n a_{n,n} \sqsubseteq \bigsqcup_n c_n$.
    
    За другата посока, да разгледаме произволен елемент $a_{n,m}$.
    Нека $k = \max\{n,m\}$.
    Ясно е, че $a_{n,m} \sqsubseteq a_{k,k} \sqsubseteq \bigsqcup_n a_{n,n}$.
    Следователно, $\bigsqcup_n a_{n,n}$ е горна граница на верига ${(a_{m,n})}^{\infty}_{m=0}$
    и оттук получаваме, че за всяко $n$, $c_n \sqsubseteq \bigsqcup_n a_{n,n}$.
    Получаваме, че $\bigsqcup_n a_{n,n}$ е горна граница на веригата $\chain{c}{n}$ и следователно
    $\bigsqcup_n c_n \sqsubseteq \bigsqcup_n a_{n,n}$.
  \end{enumerate}
  С това доказателството на теоремата е завършено.
\end{proof}

\begin{framed}
  \begin{lemma}
    Нека $\A$ и $\B$ са области на Скот.
    Нека $\chain{f}{k}$ е верига от елементи на $\Cont{\A}{\B}$.
    Да дефинираме изображението $h$ на $\A$ в $\B$ по следния начин
    \[h(a) \df \bigsqcup\{f_k(a) \mid k \in \Nat\}.\]
    Изображението $h$ е {\em непрекъснато} и е {\em точна горна граница} на веригата $\chain{f}{k}$,
    т.е. $h = \bigsqcup_k f_k$.
  \end{lemma}
\end{framed}
\marginpar{Ако $b_k = f_k(a)$, то $h(a)$ е точната горна граница на веригата $\chain{b}{k}$ в $\B$}
\begin{proof}
  \ifhints
  Доказателството, че $h$ е точна горна граница на веригата $\chain{f}{k}$ е лесно.
  \begin{itemize}
  \item 
    Да разгледаме произволен елемент $a \in A$.
    Лесно се вижда, че понеже $\chain{f}{k}$ е верига, то $(f_k(a))^\infty_{k=0}$ също е верига.
    % Това е така, защото всяко непрекъснато изображение е също така и монотонно.

    \marginpar{$\bigsqcup_n f_n(a)$ е съкратен запис за $\bigsqcup\{f_n(a) \mid n \in \Nat\}$.}
    Получаваме, че за всяко $k$, $f_k(a) \sqsubseteq^\B \bigsqcup_n f_n(a) \df h(a)$.
    Понеже това е вярно за произволно $a \in A$, $(\forall k)[f_k \sqsubseteq h]$,
    което означава, че $h$ е горна граница на веригата.
  \item
    Да разгледаме произволно изображение $g$, което е горна граница на веригата $\chain{f}{k}$.
    За произволен елемент $a \in A$, 
    \[(\forall k)[f_k(a) \sqsubseteq^\B g(a)].\]
    Това означава, че $g(a)$ е горна граница на веригата ${(f_k(a))}^\infty_{k=0}$.
    Понеже $h(a) = \bigsqcup_k \{f_k(a)\}$ е точната горна граница на веригата ${(f_k(a))}^\infty_{k=0}$,
    то $h(a) \sqsubseteq^\B g(a)$.
    Оттук следва, че $h \sqsubseteq g$.
  \end{itemize}
  \fi
  По-сложната част на доказателството е проверката, че $h$ е непрекъснато изображение.
  Да вземем една монотонно растяща редица $\chain{a}{k}$ от елементи на $A$.
  \marginpar{За момента дори не е ясно дали $\{h(a_k) \mid k \in \Nat\}$ е верига в $\B$}
  Ще докажем, че \[h(\bigsqcup_k a_k) = \bigsqcup_k \{h(a_k)\}.\]
  Нека $e_{n,m} \df f_n(a_m)$.
  Понеже всяко $f_n$ е непрекъснато и следователно монотонно изображение, то имаме
  \[n \leq n^\prime\ \&\ m \leq m^\prime\ \Rightarrow\ e_{n,m} \sqsubseteq^{\B} e_{n^\prime,m^\prime}.\]
  Следователно,
  \begin{align*}
    h(\bigsqcup_m a_m) & = \bigsqcup_n(f_n(\bigsqcup_m a_m)) & \comment{\text{от деф. на }h}\\
                       & = \bigsqcup_n(\bigsqcup_m f_n(a_m)) & \comment{\text{ защото } f_n \text{ е непр.}}\\
                       & = \bigsqcup_n(\bigsqcup_m e_{n,m}) = \bigsqcup_m(\bigsqcup_n e_{n,m}) & \comment{\text{от \Th{double-chain}}}\\
                       & = \bigsqcup_m(\bigsqcup_n f_n(a_m)) & \comment{\text{от деф. на }e_{n.m}}\\
                       & = \bigsqcup_m \{h(a_m)\}. & \comment{\text{от деф. на }h}
  \end{align*}
\end{proof}

Да напомним, че релацията $\sqsubseteq$ между две изображения е дефинирана като
\[f \sqsubseteq g \dfff (\forall a\in A)[f(a) \sqsubseteq^\B g(a)].\]
\begin{framed}
  \begin{theorem}
    \label{th:continuous-domain}
    Ако $\A$ и $\B$ са области на Скот, то $\Cont{\A}{\B}$ е област на Скот.
  \end{theorem}
\end{framed}

Нека $\A_1,\dots,\A_n$ и $\A$ са области на Скот и да разгледаме $f: \A_1\times \dots \times \A_n \to \A$.
Казваме, че $f$ е {\bf непрекъснато изображение по $i$-тия аргумент}, ако 
за всяка верига $\chain{a}{k}$ в $\A_i$, то
\[f(b_1,\dots, b_{i-1}, \bigsqcup_k a_k, b_{i+1},\dots,b_n) = \bigsqcup_k f(b_1,\dots, b_{i-1}, a_k, b_{i+1},\dots,b_n).\]

\begin{proposition}
  \label{pr:continuous-arguments}
  \marginpar{\cite[стр. 184]{models-of-computation}}
  Нека $\A_1,\dots,\A_n$ и $\A$ са области на Скот. Едно изображение
  \[f: \A_1\times \dots \times \A_n \to \A\]
  е непрекъснато точно тогава, когато $f$ е непрекъснато по всеки от аргументите си.
\end{proposition}
\begin{proof}
  \marginpar{\writedown Обобщете това твърдение за $n > 2$.}
  За по-просто изложение, да разгледаме случая $n = 2$.

  $(\Rightarrow)$ Лесно се съобразява, че ако $f$ е непрекъснато изображение, то $f$ е непрекъснато по всеки от аргументите си.
  Да видим например защо $f$ е непрекъснато по първия аргумент.
  Да разгледаме веригата ${(\pair{a_i,b})}^\infty_{i=0}$ от елементи на $\A\times\B$, за някое фиксирано $b$.
  Знаем, че $\bigsqcup_i \pair{a_i,b} = \pair{\bigsqcup_ia_i,b}$.
  Тогава
  \marginpar{Формално погледнато, правилно е да пишем $f(\pair{a,b})$ вместо $f(a,b)$.}
  \begin{align*}
    f(\bigsqcup_i a_i,b) & = f(\bigsqcup_i\pair{a_i,b}) \\
                        & = \bigsqcup_i f(a_i,b) & \comment{f\text{ е непрекъснато}}.
  \end{align*}
    
  $(\Leftarrow)$ Нека сега $f$ е непрекъснато по всеки от аргументите си. Ще докажем, че $f$ е непрекъснато.
  Нека ${\{\pair{a_n,b_n}\}}^\infty_{n=0}$ е верига в $\A_1\times \A_2$.
  Понеже от \Prop{cartesian} знаем, че
  \[\bigsqcup_n\pair{a_n,b_n} = \pair{\bigsqcup_n a_n,\bigsqcup_n b_n},\]
  ще докажем, че 
  \[\bigsqcup_n f(a_n,b_n) = f(\bigsqcup_n a_n,\bigsqcup_n b_n).\]
  Да положим $e_{n,m} = f(a_n,b_m)$.
  Понеже $f$ е непрекъснато по всеки от аргументите си, лесно се вижда, че $f$
  е монотонно изображение по всеки от аргументите си. Следователно, 
  \[n \leq n^\prime\ \&\ m \leq m^\prime\ \Rightarrow\ e_{n,m} \sqsubseteq e_{n^\prime,m^\prime}.\]  
  Получаваме, че
  \begin{align*}
    \bigsqcup_n f(a_n,b_n) & = \bigsqcup_n e_{n,n} & \comment{\text{от опр. на }e_{n,m}}\\
                           & = \bigsqcup_n (\bigsqcup_m e_{n,m}) & \comment{\text{от \Th{double-chain}}}\\
                           & = \bigsqcup_n (\bigsqcup_m f(a_n,b_m)) & \comment{\text{от опр. на }e_{n,m}}\\
                           & = \bigsqcup_n f(a_n,\bigsqcup_m b_m) & \comment{f \text{ е непр. по втория си аргумент}}\\
                           & = f(\bigsqcup_n a_n,\bigsqcup_m b_m) & \comment{f \text{ е непр. по първия си аргумент}}.
  \end{align*}
\end{proof}


% \begin{problem}
%   Нека $f:\A\times\B$
% \end{problem}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../sep"
%%% End:
