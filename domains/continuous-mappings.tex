\subsection{Непрекъснати изображения}\index{изображение!непрекъснато}

\marginpar{На англ. {\em continuous}}
Едно изображение $f:\A_1\to \A_2$ се нарича {\bf непрекъснато}, ако са изпълнени свойствата:
\begin{itemize}
\item
  $f$ е монотонно изображение;
\item
  при всеки избор на верига $\chain{a}{i}$ в $\A_1$, имаме равенството
  \marginpar{Понеже $\A_1$ е област на Скот знаем, че $\bigsqcup_i a_i \in \A_1$}
  \marginpar{Понеже $f$ е монотонно, то ${(f(a_i))}^{\infty}_{i=0}$ е верига.}
  \marginpar{$\bigsqcup_i f(a_i) \df \bigsqcup\{f(a_i) \mid i \in \Nat\}$}
  \[f(\bigsqcup_i a_i) = \bigsqcup \{f(a_i) \mid i \in \Nat\}.\]  
\end{itemize}
Да означим
\[\Cont{\A_1}{\A_2} \df (\{f: \A_1 \to \A_2 \mid f\text{ е непр. изобр.}\},\ \sqsubseteq,\ \bm{\bot}).\]

% \begin{framed}
%   \begin{prop}
%     \label{pr:continuous-is-monotone}
%     За произволни области на Скот $\A_1$ и $\A_2$, всяко непрекъснато изображение $f:\A_1 \to \A_2$ е монотонно, т.е.
%     \[\Cont{\A_1}{\A_2}\ \subseteq\ \Mon{\A_1}{\A_2}.\]
%   \end{prop}
% \end{framed}
% \begin{proof}
%   Нека $f \in \Cont{\A_1}{\A_2}$.
%   Да вземем два произволни елемента в $\A_1$, за които $a \sqsubseteq_1 b$.
%   Ще докажем, че $f(a) \sqsubseteq_2 f(b)$.
%   Да разгледаме веригата $\chain{a}{i}$ в $\A_1$, където:
%   \[\underbrace{a_0}_{a} \sqsubseteq \underbrace{a_1}_{b} = \underbrace{a_2}_{b} = \underbrace{a_3}_{b} = \cdots\]
%   Ясно е, че 
%   \[\bigsqcup\{a_i \mid i \in \Nat\} = \bigsqcup\{a,b\} = b.\]
%   Тогава от непрекъснатостта на $f$ имаме, че
%   \begin{align*}
%     f(a) & = f(a_0) & \comment{\text{защото }a_0 \df a}\\
%     & \sqsubseteq_2 \bigsqcup\{f(a_i) \mid i \in \Nat\} & \comment{\text{защото }f(a_0) \in \{f(a_i) \mid i\in\Nat\}}\\
%     & = f(\bigsqcup_i a_i) & \comment{\text{защото $f$ е непр.}}\\
%     & = f(\bigsqcup\{a,b,b,b,\dots\}) & \comment{\text{от избора на веригата }\chain{a}{i}}\\
%     & = f(b) & \comment{\text{защото }a \sqsubseteq_1 b}.
%   \end{align*}
%   Така получихме, че за произволни $a,b\in\A_1$, 
%   \[a \sqsubseteq_1 b \implies f(a) \sqsubseteq_2 f(b).\]
% \end{proof}

Ясно е, че всяко непрекъснато изображение е монотонно.
Ествено е да си зададем въпроса дали имаме и обратното включване.
Оказва се, че в общия случай не е вярно, че всяко монотонно изображение е непрекъснато.

\begin{proposition}\label{pr:continuous-mappings-not-monotone}  
  Съществува област на Скот $\A$, за която
  \[\Cont{\A}{\A} \subsetneqq \Mon{\A}{\A}.\]
\end{proposition}
\begin{hint}
  Нека $A = \{a_n \mid n \in \Nat\} \cup \{a_\omega, b\}$.
  Да разгледаме областта на Скот $\A = (A, \sqsubseteq, a_0)$, където 
  наредбата между елементите е следната:
  \[a_0 \sqsubseteq a_1 \sqsubseteq \cdots \sqsubseteq a_n \sqsubseteq \cdots \sqsubseteq a_\omega \sqsubseteq b. \]
  Нека $f(a_n) = a_{n+1}$, $f(a_{\omega}) = b$ и $f(b) = b$.
  Очевидно е, че $f$ е монотонно изображение.
  Лесно се вижда, че $f$ не е непрекъснато изображение, 
  защото
  \[f(\bigsqcup_n a_n) = f(a_\omega) = b,\]
  но 
  \[\bigsqcup_n f(a_n) = \bigsqcup_n a_{n+1} = a_\omega.\]
\end{hint}

Сега да видим един важен за нас случай, при който имаме и обратното включване.
\marginpar{В Раздел~\ref{subsect:domains:product} дефинирахме какво означава една верига $\chain{n}{a}$ да се стабилизира: съществува индекс $n_0$, за който \[(\forall n \geq n_0)[a_{n_0} = a_{n}].\]}

\begin{framed}
  \begin{proposition}\label{pr:stab-continuous}
    Ако всяка верига в $\A_1$ се {\em стабилизира}, то
    \[\Mon{\A_1}{\A_2} \subseteq \Cont{\A_1}{\A_2}.\]
  \end{proposition}
\end{framed}
\begin{hint}
  Да разгледаме една верига $\chain{a}{i}$ в $\A_1$ и $f \in \Mon{\A_1}{\A_2}$.
  Ще докажем, че \[f(\bigsqcup_i a_i) = \bigsqcup_i f(a_i).\]

  \begin{enumerate}[(1)]
  \item
    % \marginpar{Това включване е вярно за произволна област на Скот $\A_1$.}
    % Ясно е, че за всяко монотонно изображение $f$,
    % понеже $a_i \sqsubseteq \bigsqcup_i a_i$, то $f(a_i) \sqsubseteq f(\bigsqcup_i a_i)$.
    % Това означава, че $f(\bigsqcup_i a_i)$ е горна граница на веригата $(f(a_i))^\infty_{i=0}$ в $\A_2$
    % и следователно
    % \[\bigsqcup_i f(a_i) \sqsubseteq f(\bigsqcup_i a_i).\]
    От \Prop{monotone-chain} веднага получаваме, че
    \[\bigsqcup_i f(a_i) \sqsubseteq f(\bigsqcup_i a_i).\]
  \item
    За другата посока ще използваме свойството, че веригата $\chain{a}{i}$ се стабилизира.
    Нека $n_0$ е индекс, такъв че $(\forall k \geq n_0)[a_k = a_{n_0}]$.
    Това означава, че $\bigsqcup_i a_i = a_{n_0}$.
    Тогава
    \[f(\bigsqcup_i a_i) = f(a_{n_0}) \sqsubseteq \bigsqcup_i f(a_i).\]
  \end{enumerate}
  
  От $(1)$ и $(2)$ следва, че $f(\bigsqcup_i a_i) = \bigsqcup_i f(a_i)$.
\end{hint}

От Раздел~\ref{subsect:domains:product} знаем, че всяка верига в $\Nat^n_\bot$ се {\em стабилизира}, то
получаваме следното важно следствие.
\begin{framed}
\begin{corollary}\label{cr:monotone-is-continuous}
  $\Mon{\Nat^n_\bot}{\Nat_\bot} = \Cont{\Nat^n_\bot}{\Nat_\bot}$.
\end{corollary}  
\end{framed}

% От доказателството на (1) за \Prop{stab-continuous} можем да извлечем следното свойство,
% което ще ни бъде полезно по-нататък.
% \begin{proposition}\label{pr:monotone-chain}
%   За всяко изображение $f \in \Mon{\A}{\B}$ и всяка верига $\chain{a}{i}$, е изпълнено, че
%   \[\bigsqcup_i f(a_i) \sqsubseteq f(\bigsqcup_i a_i).\]
% \end{proposition}

Понеже от \Cor{flat-monotone-is-domain} имаме, че монотонните изображения образуват област на Скот, 
то директно получаваме следната важна теорема.

\begin{framed}
\begin{theorem}
  \label{th:continuous-is-domain}
  $\Cont{\Nat^n_\bot}{\Nat_\bot}$ е област на Скот.
\end{theorem}
\end{framed}
% \begin{proof}
%   От \Cor{monotone-is-continuous} имаме, че 
%   \[\Mon{\Nat^n_\bot}{\Nat_\bot} = \Cont{\Nat^n_\bot}{\Nat_\bot}.\]
%   От \Cor{flat-monotone-is-domain} имаме, че 
%   \[(\Mon{\Nat^n_\bot}{\Nat_\bot}, \sqsubseteq, \Omega^{(n)})\]
%   е област на Скот. 
%   Оттук директно получаваме, че 
%   \[(\Cont{\Nat^n_\bot}{\Nat_\bot}, \sqsubseteq, \Omega^{(n)})\] е област на Скот.
% \end{proof}


% \begin{prop}
%   \label{pr:composition}
%   \index{изображения!композиция}
%   Ако $f \in \Cont{\A}{B}$ и $g \in \Cont{\B}{\C}$, то $g \circ f \in \Cont{\A}{\C}$,
%   където \[(g\circ f)(a) \df g(f(a)).\]
% \end{prop}
% \begin{hint}
%   Нека $\chain{a}{i}$ е верига в $\A$.
%   Да обърнем внимание, че понеже $f \in \Cont{\A}{\B}$,
%   то $f$ е монотонно изображение и тогава $(f(a_i))^\infty_{i=0}$ е верига в $\B$.
%   Тогава:
%   \begin{align*}
%     (g \circ f)(\bigsqcup_i a_i) & = g(f(\bigsqcup_i a_i)) & \comment{\text{от деф.}}\\
%     & = g(\bigsqcup_i f(a_i)) & \comment{f \text{ е непр.}}\\
%     & = \bigsqcup_i g(f(a_i)) & \comment{g \text{ е непр.}}
%   \end{align*}
% \end{hint}


\begin{problem}
  \marginpar{\cite[стр. 124]{reynolds}}
  Нека $f \in \Mon{\A}{\B}$ и $g \in \Mon{\B}{\A}$ имат свойствата:
  \begin{itemize}
  \item 
    $f\circ g = id_\B$;
  \item
    $g \circ f = id_\A$.
  \end{itemize}
  Докажете, че $f$ и $g$ са непрекъснати.
\end{problem}


% \begin{problem}
%   Нека $f_0 \sqsubseteq f_1 \sqsubseteq f_2 \sqsubseteq \cdots$
%   е верига от елементи на $\Cont{\A}{\A}$.
%   Да положим $h = \bigsqcup_n f_n$.
%   Вярно ли е, че 
%   \[h \circ h = \bigsqcup_n (f_n \circ f_n)?\]
%   Обосновете се!
% \end{problem}


\marginpar{Много от задачите са от \cite[стр. 31]{abramsky94}}

\begin{problem}
  Да разгледаме непрекъснатите изображения
  \[\Gamma,\Delta \in \Cont{\Cont{\A}{\A}}{\Cont{\A}{\A}}.\]
  \marginpar{Знаем, че изображението $\Gamma \circ \Delta$ е непрекъснато, където
    \[(\Gamma\circ\Delta)(f) \df \Gamma(\Delta(f)).\]}
  Винаги ли е вярно, че 
  \[\lfp(\Gamma \circ \Delta) \sqsubseteq \lfp(\Gamma) \circ \lfp(\Delta)?\]
  Обосновете се!
\end{problem}
% \ifhints
\begin{hint}
  Ще дадем контрапример.
  Нека $\A = \Nat_\bot$.
  Нека например да разгледаме
  \begin{align*}
    & \Delta(f)(x) \df f(x+1)\\
    & \Gamma(f)(x) \df
      \begin{cases}
        0, & x \neq \bot\\
        \bot, & x = \bot.
      \end{cases}
  \end{align*}
  Да положим $f_\Gamma \df \lfp(\Gamma)$ и $f_\Delta \df \lfp(\Delta)$.
  Ясно е, че 
  \begin{align*}
    & f_\Delta(x) = \bot\\
    & f_\Gamma(x) =
    \begin{cases}
      0, & x \neq \bot\\
      \bot, & x = \bot.
    \end{cases}  
  \end{align*}
  Тогава за произволно $x \in \Nat_\bot$,
  \[(f_\Gamma\circ f_\Delta)(x) = f_\Gamma(f_\Delta(x)) = f_\Gamma(\bot)  = \bot.\]
  От друга страна, понеже $(\Gamma \circ \Delta)(f) = \Gamma(\Delta(f))$, то 
  \begin{align*}
    & (\Gamma \circ \Delta)(f)(x) = \Gamma(\Delta(f))(x) = 
      \begin{cases}
        0, & x \neq \bot\\
        \bot, & x = \bot.
      \end{cases}
  \end{align*}
  Лесно се съобразява, че 
  \[\lfp(\Gamma \circ \Delta)(x) =
  \begin{cases}
    0, & x \neq \bot\\
    \bot, & x = \bot.
  \end{cases}\]
  Заключаваме, че 
  \[\lfp(\Gamma \circ \Delta) \sqsupset \lfp(\Gamma) \circ \lfp(\Delta).\]
\end{hint}
% \fi


\begin{problem}
  Да разгледаме операторите \[\Gamma,\Delta \in \Cont{\Cont{\A}{\A}}{\Cont{\A}{\A}}.\]
  Знаем, че операторът $\Gamma \circ \Delta$ е непрекъснат, където
  \[(\Gamma\circ\Delta)(f) \df \Gamma(\Delta(f)).\]
  Винаги ли е вярно, че:
  \[\lfp(\Gamma \circ \Delta) \sqsupseteq \lfp(\Gamma) \circ \lfp(\Delta)?\]
  Обосновете се!
\end{problem}
% \ifhints
\begin{hint}
  Ще дадем контрапример.
  Нека $\A = \Nat_\bot$.
  Нека например да разгледаме
  \begin{align*}
    & \Delta(f)(x) \df 0\\
    & \Gamma(f)(x) \df
      \begin{cases}
        0, & x = 0\\
        \bot, & \text{ иначе}.
      \end{cases}
  \end{align*}
  Да положим $f_\Gamma \df \lfp(\Gamma)$ и $f_\Delta \df \lfp(\Delta)$.
  Ясно е, че 
  \begin{align*}
    & f_\Delta(x) = 0\\
    & f_\Gamma(x) =
    \begin{cases}
      0, & x = 0\\
      \bot, & \text{ иначе}.
    \end{cases}  
  \end{align*}
  Тогава за произволно $x \in \Nat_\bot$,
  \[(f_\Gamma\circ f_\Delta)(x) = f_\Gamma(f_\Delta(x)) = f_\Gamma(0)  = 0.\]
  От друга страна, понеже $(\Gamma \circ \Delta)(f) = \Gamma(\Delta(f))$, то 
  \begin{align*}
    & (\Gamma \circ \Delta)(f)(x) = \Gamma(\Delta(f))(x) = 
      \begin{cases}
        0, & x = 0\\
        \bot, & \text{ иначе}.
      \end{cases}
  \end{align*}
  Лесно се съобразява, че 
  \[\lfp(\Gamma \circ \Delta)(x) =
  \begin{cases}
    0, & x = 0\\
    \bot, & \text{ иначе}.
  \end{cases}\]
  Заключаваме, че 
  \[\lfp(\Gamma \circ \Delta) \sqsubset \lfp(\Gamma) \circ \lfp(\Delta).\]
\end{hint}
% \fi


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../sep"
%%% End:
